<!doctype html>
<html lang="en">
<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
          integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

    <title>Workflow.VAT</title>
    <style>
        canvas {
            -moz-user-select: none;
            -webkit-user-select: none;
            -ms-user-select: none;
        }
    </style>
</head>
<body>

<div class="container">
    <div class="row">
        <div class="col-4">
            <h1 class="display-4" id="model-id"></h1>
        </div>
        <div class="col-8">
            <div class="form-row form-inline float-right">
                <div class="col">
                    From <input type="date" class="form-control" id="from"> To <input type="date" id="to"
                                                                                      class="form-control d-inline">
                </div>
            </div>
            <!--div class="form-row form-inline float-right">
                <div class="col">
                    From <input type="date" class="form-control" value="2018-12-01"> To <input type="date" class="form-control d-inline" value="2018-12-31">
                </div>
            </div-->
        </div>
    </div>
    <div class="row mt-4">
        <div class="col">
            <dl class="row">
                <dt class="col-4">Samples</dt>
                <dd class="col-8"><span id="n-samples"></span><i class="material-icons float-right">help_outline</i>
                </dd>
                <dt class="col-4">Classes</dt>
                <dd class="col-8"><span id="n-classes"></span><i class="material-icons float-right">help_outline</i>
                </dd>
            </dl>
        </div>
        <div class="col">
            <dl class="row">
                <dt class="col-4">Correct</dt>
                <dd class="col-8"><span id="correct"></span>% <i class="material-icons float-right">help_outline</i>
                </dd>
                <dt class="col-4">Errors</dt>
                <dd class="col-8"><span id="errors"></span>%<i class="material-icons float-right">help_outline</i></dd>
                <dt class="col-4">Abstentions</dt>
                <dd class="col-8"><span id="abstain"></span>% <i class="material-icons float-right">help_outline</i>
                </dd>
            </dl>
        </div>
    </div>
    <div class="row">
        <div class="col">
            <h3 class="d-inline">Abstain threshold</h3>
            <i class="material-icons float-right">help_outline</i>
        </div>
    </div>
    <div class="row">
        <div class="col-8">
            <canvas id="errors-correct-abstain-graph" width="700" height="240"></canvas>
            <br/>
            <canvas id="cost-graph" width="700" height="240" ></canvas>
        </div>
        <div class="col-4">
            <p class="small">
                By setting a threshold you can make the classifier abstain unless its score is above the threshold. This
                can be useful in cases where abstaining cost less than making errors.
                <br/>
                <br/>
                Specify the average cost of the different outcomes and select the threshold that minimizes the average
                cost.
            </p>
            <form>
                <div class="form-group">
                    <input type="number" class="form-control" id="error-cost" aria-describedby="cost-error-help_outline"
                           placeholder="Enter cost">
                    <small id="cost-error-help_outline" class="form-text text-muted">Cost of making an error.</small>
                </div>
                <div class="form-group">
                    <input type="number" class="form-control" id="abstain-cost"
                           aria-describedby="cost-abstain-help_outline" placeholder="Enter cost">
                    <small id="cost-abstain-help_outline" class="form-text text-muted">Cost of abstaining.</small>
                </div>
                <div class="form-group">
                    <input type="number" class="form-control" id="correct-cost"
                           aria-describedby="cost-correct-help_outline" placeholder="Enter cost">
                    <small id="cost-correct-help_outline" class="form-text text-muted">Cost of making a correct
                        classification.
                    </small>
                </div>
                <p>
                    <strong>Drag the threshold on the graph on the left</strong>
                </p>
                <dl class="row">
                    <dt class="col-6">Average cost</dt>
                    <dd class="col-6"><strong id="average-cost"></strong><i class="material-icons float-right">help_outline</i>
                    </dd>
                </dl>
                <button type="submit" class="btn btn-primary">Save threshold</button>
            </form>
        </div>
    </div>
    <!--div class="row">
        <div class="col">
            <h3>Details</h3>
        </div>
    </div>
    <div class="row">
        <div class="col">
            <h6 class="d-inline">Precision/Recall</h6>
            <i class="material-icons float-right">help_outline</i>
            <img src="pr.png" class="figure-img img-fluid rounded" alt="foo">
        </div>
        <div class="col">
            <h6 class="d-inline">Receiver Operating Characteristic</h6>
            <i class="material-icons float-right">help_outline</i>
            <img src="roc.png" class="figure-img img-fluid rounded" alt="foo">
        </div>
        <div class="col">
            <h6 class="d-inline">Calibration</h6>
            <i class="material-icons float-right">help_outline</i>
            <img src="calibration.png" class="figure-img img-fluid rounded" alt="foo">
        </div>
    </div-->
</div>

<!-- Optional JavaScript -->
<!-- jQuery first, then Popper.js, then Bootstrap JS -->
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
        integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
        crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"
        integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49"
        crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"
        integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy"
        crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.6.0/Chart.bundle.min.js"></script>
<script>
    /*!
 * chartjs-plugin-annotation.js
 * http://chartjs.org/
 * Version: 0.5.7
 *
 * Copyright 2016 Evert Timberg
 * Released under the MIT license
 * https://github.com/chartjs/Chart.Annotation.js/blob/master/LICENSE.md
 */
    !function e(t,n,i){function o(r,l){if(!n[r]){if(!t[r]){var s="function"==typeof require&&require;if(!l&&s)return s(r,!0);if(a)return a(r,!0);var c=new Error("Cannot find module '"+r+"'");throw c.code="MODULE_NOT_FOUND",c}var u=n[r]={exports:{}};t[r][0].call(u.exports,function(e){var n=t[r][1][e];return o(n?n:e)},u,u.exports,e,t,n,i)}return n[r].exports}for(var a="function"==typeof require&&require,r=0;r<i.length;r++)o(i[r]);return o}({1:[function(e,t,n){},{}],2:[function(e,t,n){t.exports=function(t){function n(e){a.decorate(e,"afterDataLimits",function(e,t){e&&e(t),a.adjustScaleRange(t)})}function i(e){return function(t,n){var i=t.annotation.options.drawTime;a.elements(t).filter(function(t){return e===(t.options.drawTime||i)}).forEach(function(e){e.transition(n).draw()})}}var o=t.helpers,a=e("./helpers.js")(t),r=e("./events.js")(t),l=t.Annotation.types;return{beforeInit:function(e){var t=e.options,i=e.annotation={elements:{},options:a.initConfig(t.annotation||{}),onDestroy:[],firstRun:!0,supported:!1};e.ensureScalesHaveIDs(),t.scales&&(i.supported=!0,o.each(t.scales.xAxes,n),o.each(t.scales.yAxes,n))},beforeUpdate:function(e){var t=e.annotation;if(t.supported){t.firstRun?t.firstRun=!1:t.options=a.initConfig(e.options.annotation||{});var n=[];t.options.annotations.forEach(function(i){var o=i.id||a.objectId();if(!t.elements[o]&&l[i.type]){var r=l[i.type],s=new r({id:o,options:i,chartInstance:e});s.initialize(),t.elements[o]=s,i.id=o,n.push(o)}else t.elements[o]&&n.push(o)}),Object.keys(t.elements).forEach(function(e){n.indexOf(e)===-1&&(t.elements[e].destroy(),delete t.elements[e])})}},afterScaleUpdate:function(e){a.elements(e).forEach(function(e){e.configure()})},beforeDatasetsDraw:i("beforeDatasetsDraw"),afterDatasetsDraw:i("afterDatasetsDraw"),afterDraw:i("afterDraw"),afterInit:function(e){var t=e.annotation.options.events;if(o.isArray(t)&&t.length>0){var n=e.chart.canvas,i=r.dispatcher.bind(e);r.collapseHoverEvents(t).forEach(function(t){o.addEvent(n,t,i),e.annotation.onDestroy.push(function(){o.removeEvent(n,t,i)})})}},destroy:function(e){for(var t=e.annotation.onDestroy;t.length>0;)t.pop()()}}}},{"./events.js":4,"./helpers.js":5}],3:[function(e,t,n){t.exports=function(e){var t=e.helpers,n=e.Element.extend({initialize:function(){this.hidden=!1,this.hovering=!1,this._model=t.clone(this._model)||{},this.setDataLimits()},destroy:function(){},setDataLimits:function(){},configure:function(){},inRange:function(){},getCenterPoint:function(){},getWidth:function(){},getHeight:function(){},getArea:function(){},draw:function(){}});return n}},{}],4:[function(e,t,n){t.exports=function(t){function n(e){var t=!1,n=e.filter(function(e){switch(e){case"mouseenter":case"mouseover":case"mouseout":case"mouseleave":return t=!0,!1;default:return!0}});return t&&n.indexOf("mousemove")===-1&&n.push("mousemove"),n}function i(e){var t=this.annotation,i=a.elements(this),r=o.getRelativePosition(e,this.chart),l=a.getNearestItems(i,r),s=n(t.options.events),c=t.options.dblClickSpeed,u=[],f=a.getEventHandlerName(e.type),d=(l||{}).options;if("mousemove"===e.type&&(l&&!l.hovering?["mouseenter","mouseover"].forEach(function(t){var n=a.getEventHandlerName(t),i=a.createMouseEvent(t,e);l.hovering=!0,"function"==typeof d[n]&&u.push([d[n],i,l])}):l||i.forEach(function(t){if(t.hovering){t.hovering=!1;var n=t.options;["mouseout","mouseleave"].forEach(function(i){var o=a.getEventHandlerName(i),r=a.createMouseEvent(i,e);"function"==typeof n[o]&&u.push([n[o],r,t])})}})),l&&s.indexOf("dblclick")>-1&&"function"==typeof d.onDblclick){if("click"===e.type&&"function"==typeof d.onClick)return clearTimeout(l.clickTimeout),l.clickTimeout=setTimeout(function(){delete l.clickTimeout,d.onClick.call(l,e)},c),e.stopImmediatePropagation(),void e.preventDefault();"dblclick"===e.type&&l.clickTimeout&&(clearTimeout(l.clickTimeout),delete l.clickTimeout)}l&&"function"==typeof d[f]&&0===u.length&&u.push([d[f],e,l]),u.length>0&&(e.stopImmediatePropagation(),e.preventDefault(),u.forEach(function(e){e[0].call(e[2],e[1])}))}var o=t.helpers,a=e("./helpers.js")(t);return{dispatcher:i,collapseHoverEvents:n}}},{"./helpers.js":5}],5:[function(e,t,n){function i(){}function o(e){var t=e.annotation.elements;return Object.keys(t).map(function(e){return t[e]})}function a(){return Math.random().toString(36).substr(2,6)}function r(e){return null!==e&&"undefined"!=typeof e&&("number"==typeof e?isFinite(e):!!e)}function l(e,t,n){var i="$";e[i+t]||(e[t]?(e[i+t]=e[t].bind(e),e[t]=function(){var o=[e[i+t]].concat(Array.prototype.slice.call(arguments));return n.apply(e,o)}):e[t]=function(){var t=[void 0].concat(Array.prototype.slice.call(arguments));return n.apply(e,t)})}function s(e,t){e.forEach(function(e){(t?e[t]:e)()})}function c(e){return"on"+e[0].toUpperCase()+e.substring(1)}function u(e,t){try{return new MouseEvent(e,t)}catch(n){try{var i=document.createEvent("MouseEvent");return i.initMouseEvent(e,t.canBubble,t.cancelable,t.view,t.detail,t.screenX,t.screenY,t.clientX,t.clientY,t.ctrlKey,t.altKey,t.shiftKey,t.metaKey,t.button,t.relatedTarget),i}catch(o){var a=document.createEvent("Event");return a.initEvent(e,t.canBubble,t.cancelable),a}}}t.exports=function(e){function t(t){return t=h.configMerge(e.Annotation.defaults,t),h.isArray(t.annotations)&&t.annotations.forEach(function(t){t.label=h.configMerge(e.Annotation.labelDefaults,t.label)}),t}function n(e,t,n,i){var o=t.filter(function(t){return!!t._model.ranges[e]}).map(function(t){return t._model.ranges[e]}),a=o.map(function(e){return Number(e.min)}).reduce(function(e,t){return isFinite(t)&&!isNaN(t)&&t<e?t:e},n),r=o.map(function(e){return Number(e.max)}).reduce(function(e,t){return isFinite(t)&&!isNaN(t)&&t>e?t:e},i);return{min:a,max:r}}function f(e){var t=n(e.id,o(e.chart),e.min,e.max);"undefined"==typeof e.options.ticks.min&&"undefined"==typeof e.options.ticks.suggestedMin&&(e.min=t.min),"undefined"==typeof e.options.ticks.max&&"undefined"==typeof e.options.ticks.suggestedMax&&(e.max=t.max),e.handleTickRangeOptions&&e.handleTickRangeOptions()}function d(e,t){var n=Number.POSITIVE_INFINITY;return e.filter(function(e){return e.inRange(t.x,t.y)}).reduce(function(e,i){var o=i.getCenterPoint(),a=h.distanceBetweenPoints(t,o);return a<n?(e=[i],n=a):a===n&&e.push(i),e},[]).sort(function(e,t){var n=e.getArea(),i=t.getArea();return n>i||n<i?n-i:e._index-t._index}).slice(0,1)[0]}var h=e.helpers;return{initConfig:t,elements:o,callEach:s,noop:i,objectId:a,isValid:r,decorate:l,adjustScaleRange:f,getNearestItems:d,getEventHandlerName:c,createMouseEvent:u}}},{}],6:[function(e,t,n){var i=e("chart.js");i="function"==typeof i?i:window.Chart,i.Annotation=i.Annotation||{},i.Annotation.drawTimeOptions={afterDraw:"afterDraw",afterDatasetsDraw:"afterDatasetsDraw",beforeDatasetsDraw:"beforeDatasetsDraw"},i.Annotation.defaults={drawTime:"afterDatasetsDraw",dblClickSpeed:350,events:[],annotations:[]},i.Annotation.labelDefaults={backgroundColor:"rgba(0,0,0,0.8)",fontFamily:i.defaults.global.defaultFontFamily,fontSize:i.defaults.global.defaultFontSize,fontStyle:"bold",fontColor:"#fff",xPadding:6,yPadding:6,cornerRadius:6,position:"center",xAdjust:0,yAdjust:0,enabled:!1,content:null},i.Annotation.Element=e("./element.js")(i),i.Annotation.types={line:e("./types/line.js")(i),box:e("./types/box.js")(i)};var o=e("./annotation.js")(i);t.exports=o,i.pluginService.register(o)},{"./annotation.js":2,"./element.js":3,"./types/box.js":7,"./types/line.js":8,"chart.js":1}],7:[function(e,t,n){t.exports=function(t){var n=e("../helpers.js")(t),i=t.Annotation.Element.extend({setDataLimits:function(){var e=this._model,t=this.options,i=this.chartInstance,o=i.scales[t.xScaleID],a=i.scales[t.yScaleID],r=i.chartArea;if(e.ranges={},r){var l=0,s=0;o&&(l=n.isValid(t.xMin)?t.xMin:o.getPixelForValue(r.left),s=n.isValid(t.xMax)?t.xMax:o.getPixelForValue(r.right),e.ranges[t.xScaleID]={min:Math.min(l,s),max:Math.max(l,s)}),a&&(l=n.isValid(t.yMin)?t.yMin:a.getPixelForValue(r.bottom),s=n.isValid(t.yMax)?t.yMax:a.getPixelForValue(r.top),e.ranges[t.yScaleID]={min:Math.min(l,s),max:Math.max(l,s)})}},configure:function(){var e=this._model,t=this.options,i=this.chartInstance,o=i.scales[t.xScaleID],a=i.scales[t.yScaleID],r=i.chartArea;e.clip={x1:r.left,x2:r.right,y1:r.top,y2:r.bottom};var l,s,c=r.left,u=r.top,f=r.right,d=r.bottom;o&&(l=n.isValid(t.xMin)?o.getPixelForValue(t.xMin):r.left,s=n.isValid(t.xMax)?o.getPixelForValue(t.xMax):r.right,c=Math.min(l,s),f=Math.max(l,s)),a&&(l=n.isValid(t.yMin)?a.getPixelForValue(t.yMin):r.bottom,s=n.isValid(t.yMax)?a.getPixelForValue(t.yMax):r.top,u=Math.min(l,s),d=Math.max(l,s)),e.left=c,e.top=u,e.right=f,e.bottom=d,e.borderColor=t.borderColor,e.borderWidth=t.borderWidth,e.backgroundColor=t.backgroundColor},inRange:function(e,t){var n=this._model;return n&&e>=n.left&&e<=n.right&&t>=n.top&&t<=n.bottom},getCenterPoint:function(){var e=this._model;return{x:(e.right+e.left)/2,y:(e.bottom+e.top)/2}},getWidth:function(){var e=this._model;return Math.abs(e.right-e.left)},getHeight:function(){var e=this._model;return Math.abs(e.bottom-e.top)},getArea:function(){return this.getWidth()*this.getHeight()},draw:function(){var e=this._view,t=this.chartInstance.chart.ctx;t.save(),t.beginPath(),t.rect(e.clip.x1,e.clip.y1,e.clip.x2-e.clip.x1,e.clip.y2-e.clip.y1),t.clip(),t.lineWidth=e.borderWidth,t.strokeStyle=e.borderColor,t.fillStyle=e.backgroundColor;var n=e.right-e.left,i=e.bottom-e.top;t.fillRect(e.left,e.top,n,i),t.strokeRect(e.left,e.top,n,i),t.restore()}});return i}},{"../helpers.js":5}],8:[function(e,t,n){t.exports=function(t){function n(e){var t=(e.x2-e.x1)/(e.y2-e.y1),n=e.x1||0;this.m=t,this.b=n,this.getX=function(i){return t*(i-e.y1)+n},this.getY=function(i){return(i-n)/t+e.y1},this.intersects=function(e,t,n){n=n||.001;var i=this.getY(e),o=this.getX(t);return(!isFinite(i)||Math.abs(t-i)<n)&&(!isFinite(o)||Math.abs(e-o)<n)}}function i(e,t,n,i,o){var a=e.line,s={},c=0,u=0;switch(!0){case e.mode==l&&"top"==e.labelPosition:u=o+e.labelYAdjust,c=t/2+e.labelXAdjust,s.y=e.y1+u,s.x=(isFinite(a.m)?a.getX(s.y):e.x1)-c;break;case e.mode==l&&"bottom"==e.labelPosition:u=n+o+e.labelYAdjust,c=t/2+e.labelXAdjust,s.y=e.y2-u,s.x=(isFinite(a.m)?a.getX(s.y):e.x1)-c;break;case e.mode==r&&"left"==e.labelPosition:c=i+e.labelXAdjust,u=-(n/2)+e.labelYAdjust,s.x=e.x1+c,s.y=a.getY(s.x)+u;break;case e.mode==r&&"right"==e.labelPosition:c=t+i+e.labelXAdjust,u=-(n/2)+e.labelYAdjust,s.x=e.x2-c,s.y=a.getY(s.x)+u;break;default:s.x=(e.x1+e.x2-t)/2+e.labelXAdjust,s.y=(e.y1+e.y2-n)/2+e.labelYAdjust}return s}var o=t.helpers,a=e("../helpers.js")(t),r="horizontal",l="vertical",s=t.Annotation.Element.extend({setDataLimits:function(){var e=this._model,t=this.options;e.ranges={},e.ranges[t.scaleID]={min:t.value,max:t.endValue||t.value}},configure:function(){var e,t,l=this._model,s=this.options,c=this.chartInstance,u=c.chart.ctx,f=c.scales[s.scaleID];if(f&&(e=a.isValid(s.value)?f.getPixelForValue(s.value):NaN,t=a.isValid(s.endValue)?f.getPixelForValue(s.endValue):e),!isNaN(e)){var d=c.chartArea;l.clip={x1:d.left,x2:d.right,y1:d.top,y2:d.bottom},this.options.mode==r?(l.x1=d.left,l.x2=d.right,l.y1=e,l.y2=t):(l.y1=d.top,l.y2=d.bottom,l.x1=e,l.x2=t),l.line=new n(l),l.mode=s.mode,l.labelBackgroundColor=s.label.backgroundColor,l.labelFontFamily=s.label.fontFamily,l.labelFontSize=s.label.fontSize,l.labelFontStyle=s.label.fontStyle,l.labelFontColor=s.label.fontColor,l.labelXPadding=s.label.xPadding,l.labelYPadding=s.label.yPadding,l.labelCornerRadius=s.label.cornerRadius,l.labelPosition=s.label.position,l.labelXAdjust=s.label.xAdjust,l.labelYAdjust=s.label.yAdjust,l.labelEnabled=s.label.enabled,l.labelContent=s.label.content,u.font=o.fontString(l.labelFontSize,l.labelFontStyle,l.labelFontFamily);var h=u.measureText(l.labelContent).width,b=u.measureText("M").width,p=i(l,h,b,l.labelXPadding,l.labelYPadding);l.labelX=p.x-l.labelXPadding,l.labelY=p.y-l.labelYPadding,l.labelWidth=h+2*l.labelXPadding,l.labelHeight=b+2*l.labelYPadding,l.borderColor=s.borderColor,l.borderWidth=s.borderWidth,l.borderDash=s.borderDash||[],l.borderDashOffset=s.borderDashOffset||0}},inRange:function(e,t){var n=this._model;return n.line&&n.line.intersects(e,t,this.getHeight())||n.labelEnabled&&n.labelContent&&e>=n.labelX&&e<=n.labelX+n.labelWidth&&t>=n.labelY&&t<=n.labelY+n.labelHeight},getCenterPoint:function(){return{x:(this._model.x2+this._model.x1)/2,y:(this._model.y2+this._model.y1)/2}},getWidth:function(){return Math.abs(this._model.right-this._model.left)},getHeight:function(){return this._model.borderWidth||1},getArea:function(){return Math.sqrt(Math.pow(this.getWidth(),2)+Math.pow(this.getHeight(),2))},draw:function(){var e=this._view,t=this.chartInstance.chart.ctx;e.clip&&(t.save(),t.beginPath(),t.rect(e.clip.x1,e.clip.y1,e.clip.x2-e.clip.x1,e.clip.y2-e.clip.y1),t.clip(),t.lineWidth=e.borderWidth,t.strokeStyle=e.borderColor,t.setLineDash&&t.setLineDash(e.borderDash),t.lineDashOffset=e.borderDashOffset,t.beginPath(),t.moveTo(e.x1,e.y1),t.lineTo(e.x2,e.y2),t.stroke(),e.labelEnabled&&e.labelContent&&(t.beginPath(),t.rect(e.clip.x1,e.clip.y1,e.clip.x2-e.clip.x1,e.clip.y2-e.clip.y1),t.clip(),t.fillStyle=e.labelBackgroundColor,o.drawRoundedRectangle(t,e.labelX,e.labelY,e.labelWidth,e.labelHeight,e.labelCornerRadius),t.fill(),t.font=o.fontString(e.labelFontSize,e.labelFontStyle,e.labelFontFamily),t.fillStyle=e.labelFontColor,t.textAlign="center",t.textBaseline="middle",t.fillText(e.labelContent,e.labelX+e.labelWidth/2,e.labelY+e.labelHeight/2)),t.restore())}});return s}},{"../helpers.js":5}]},{},[6]);
</script>
<script>
    /*!
 * chartjs-plugin-draggable.js
 * http://chartjs.org/
 * Version: 0.1.6
 *
 * Copyright 2016 Jonathon Hill
 * Released under the MIT license
 * https://github.com/compwright/chartjs-plugin-draggable/blob/master/LICENSE.md
 */
    !function(t){function e(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return t[r].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(1),i=r(o),u=n(2),a=n(6),c=new u.ChartjsDraggablePlugin([a.DraggableAnnotationAccessor]);i.default.pluginService.register(c),e.default=c},function(t,e){t.exports=Chart},function(t,e,n){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){return function(){var n=l.default.helpers.getRelativePosition(h.event,t.chart),r=Number.POSITIVE_INFINITY;return t.draggable.subject=e.map(function(e){return e.getElements(t)}).reduce(function(t,e){return t.concat(e)},[]).filter(function(t){return t.element.inRange&&t.element.getCenterPoint&&t.element.getArea}).filter(function(t){return t.element.inRange(n.x,n.y)}).reduce(function(t,e){var o=e.element.getCenterPoint(),i=l.default.helpers.distanceBetweenPoints(n,o);return i<r?(t=[e],r=i):i===r&&t.push(e),t},[]).sort(function(t,e){return t.element.getArea()-e.element.getArea()})[0],!!t.draggable.subject}}function u(t){return function(){return t.draggable.subject}}function a(t,e){return function(){return t().dispatch(e,h.event)}}Object.defineProperty(e,"__esModule",{value:!0}),e.ChartjsDraggablePlugin=void 0;var c=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),s=n(1),l=r(s),f=n(3),h=n(5);e.ChartjsDraggablePlugin=function(){function t(e){o(this,t),this.accessors=e.filter(function(t){return t.isSupported()})}return c(t,[{key:"afterInit",value:function(t){t.draggable={};var e=u(t);(0,h.select)(t.chart.canvas).call((0,f.drag)().container(t.chart.canvas).filter(i(t,this.accessors)).subject(e).on("start",a(e,"onDragStart")).on("drag",a(e,"onDrag")).on("end",a(e,"onDragEnd")))}}]),t}()},function(t,e,n){!function(t,r){r(e,n(4),n(5))}(this,function(t,e,n){"use strict";function r(){n.event.stopImmediatePropagation()}function o(t,e){var r=t.document.documentElement,o=n.select(t).on("dragstart.drag",null);e&&(o.on("click.drag",s,!0),setTimeout(function(){o.on("click.drag",null)},0)),"onselectstart"in r?o.on("selectstart.drag",null):(r.style.MozUserSelect=r.__noselect,delete r.__noselect)}function i(t,e,n,r,o,i,u,a,c,s){this.target=t,this.type=e,this.subject=n,this.identifier=r,this.active=o,this.x=i,this.y=u,this.dx=a,this.dy=c,this._=s}function u(){return!n.event.button}function a(){return this.parentNode}function c(t){return null==t?{x:n.event.x,y:n.event.y}:t}var s=function(){n.event.preventDefault(),n.event.stopImmediatePropagation()},l=function(t){var e=t.document.documentElement,r=n.select(t).on("dragstart.drag",s,!0);"onselectstart"in e?r.on("selectstart.drag",s,!0):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")},f=function(t){return function(){return t}};i.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};var h=function(){function t(t){t.on("mousedown.drag",h).on("touchstart.drag",g).on("touchmove.drag",d).on("touchend.drag touchcancel.drag",y).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function h(){if(!w&&b.apply(this,arguments)){var t=m("mouse",E.apply(this,arguments),n.mouse,this,arguments);t&&(n.select(n.event.view).on("mousemove.drag",p,!0).on("mouseup.drag",v,!0),l(n.event.view),r(),_=!1,t("start"))}}function p(){s(),_=!0,x.mouse("drag")}function v(){n.select(n.event.view).on("mousemove.drag mouseup.drag",null),o(n.event.view,_),s(),x.mouse("end")}function g(){if(b.apply(this,arguments)){var t,e,o=n.event.changedTouches,i=E.apply(this,arguments),u=o.length;for(t=0;t<u;++t)(e=m(o[t].identifier,i,n.touch,this,arguments))&&(r(),e("start"))}}function d(){var t,e,r=n.event.changedTouches,o=r.length;for(t=0;t<o;++t)(e=x[r[t].identifier])&&(s(),e("drag"))}function y(){var t,e,o=n.event.changedTouches,i=o.length;for(w&&clearTimeout(w),w=setTimeout(function(){w=null},500),t=0;t<i;++t)(e=x[o[t].identifier])&&(r(),e("end"))}function m(e,r,o,u,a){var c,s,l,f=o(r,e),h=P.copy();if(n.customEvent(new i(t,"beforestart",c,e,O,f[0],f[1],0,0,h),function(){return null!=(n.event.subject=c=A.apply(u,a))&&(s=c.x-f[0]||0,l=c.y-f[1]||0,!0)}))return function p(v){var g,d=f;switch(v){case"start":x[e]=p,g=O++;break;case"end":delete x[e],--O;case"drag":f=o(r,e),g=O}n.customEvent(new i(t,v,c,e,g,f[0]+s,f[1]+l,f[0]-d[0],f[1]-d[1],h),h.apply,h,[v,u,a])}}var _,w,b=u,E=a,A=c,x={},P=e.dispatch("start","drag","end"),O=0;return t.filter=function(e){return arguments.length?(b="function"==typeof e?e:f(!!e),t):b},t.container=function(e){return arguments.length?(E="function"==typeof e?e:f(e),t):E},t.subject=function(e){return arguments.length?(A="function"==typeof e?e:f(e),t):A},t.on=function(){var e=P.on.apply(P,arguments);return e===P?t:e},t};t.drag=h,t.dragDisable=l,t.dragEnable=o,Object.defineProperty(t,"__esModule",{value:!0})})},function(t,e,n){!function(t,n){n(e)}(this,function(t){"use strict";function e(){for(var t,e=0,r=arguments.length,o={};e<r;++e){if(!(t=arguments[e]+"")||t in o)throw new Error("illegal type: "+t);o[t]=[]}return new n(o)}function n(t){this._=t}function r(t,e){return t.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");if(r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}})}function o(t,e){for(var n,r=0,o=t.length;r<o;++r)if((n=t[r]).name===e)return n.value}function i(t,e,n){for(var r=0,o=t.length;r<o;++r)if(t[r].name===e){t[r]=u,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=n&&t.push({name:e,value:n}),t}var u={value:function(){}};n.prototype=e.prototype={constructor:n,on:function(t,e){var n,u=this._,a=r(t+"",u),c=-1,s=a.length;{if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++c<s;)if(n=(t=a[c]).type)u[n]=i(u[n],t.name,e);else if(null==e)for(n in u)u[n]=i(u[n],t.name,null);return this}for(;++c<s;)if((n=(t=a[c]).type)&&(n=o(u[n],t.name)))return n}},copy:function(){var t={},e=this._;for(var r in e)t[r]=e[r].slice();return new n(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,o=new Array(n),i=0;i<n;++i)o[i]=arguments[i+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(r=this._[t],i=0,n=r.length;i<n;++i)r[i].value.apply(e,o)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],o=0,i=r.length;o<i;++o)r[o].value.apply(e,n)}},t.dispatch=e,Object.defineProperty(t,"__esModule",{value:!0})})},function(t,e,n){!function(t,n){n(e)}(this,function(t){"use strict";function e(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===W&&e.documentElement.namespaceURI===W?e.createElement(t):e.createElementNS(n,t)}}function n(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function r(){return new o}function o(){this._="@"+(++nt).toString(36)}function i(t,e,n){return t=u(t,e,n),function(e){var n=e.relatedTarget;n&&(n===this||8&n.compareDocumentPosition(this))||t.call(this,e)}}function u(e,n,r){return function(o){var i=t.event;t.event=o;try{e.call(this,this.__data__,n,r)}finally{t.event=i}}}function a(t){return t.trim().split(/^|\s+/).map(function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}})}function c(t){return function(){var e=this.__on;if(e){for(var n,r=0,o=-1,i=e.length;r<i;++r)n=e[r],t.type&&n.type!==t.type||n.name!==t.name?e[++o]=n:this.removeEventListener(n.type,n.listener,n.capture);++o?e.length=o:delete this.__on}}}function s(t,e,n){var r=at.hasOwnProperty(t.type)?i:u;return function(o,i,u){var a,c=this.__on,s=r(e,i,u);if(c)for(var l=0,f=c.length;l<f;++l)if((a=c[l]).type===t.type&&a.name===t.name)return this.removeEventListener(a.type,a.listener,a.capture),this.addEventListener(a.type,a.listener=s,a.capture=n),void(a.value=e);this.addEventListener(t.type,s,n),a={type:t.type,name:t.name,value:e,listener:s,capture:n},c?c.push(a):this.__on=[a]}}function l(e,n,r,o){var i=t.event;e.sourceEvent=t.event,t.event=e;try{return n.apply(r,o)}finally{t.event=i}}function f(){}function h(){return[]}function p(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function v(t,e,n,r,o,i){for(var u,a=0,c=e.length,s=i.length;a<s;++a)(u=e[a])?(u.__data__=i[a],r[a]=u):n[a]=new p(t,i[a]);for(;a<c;++a)(u=e[a])&&(o[a]=u)}function g(t,e,n,r,o,i,u){var a,c,s,l={},f=e.length,h=i.length,v=new Array(f);for(a=0;a<f;++a)(c=e[a])&&(v[a]=s=bt+u.call(c,c.__data__,a,e),s in l?o[a]=c:l[s]=c);for(a=0;a<h;++a)s=bt+u.call(t,i[a],a,i),(c=l[s])?(r[a]=c,c.__data__=i[a],l[s]=null):n[a]=new p(t,i[a]);for(a=0;a<f;++a)(c=e[a])&&l[v[a]]===c&&(o[a]=c)}function d(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function y(t){return function(){this.removeAttribute(t)}}function m(t){return function(){this.removeAttributeNS(t.space,t.local)}}function _(t,e){return function(){this.setAttribute(t,e)}}function w(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function b(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function E(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function A(t){return function(){this.style.removeProperty(t)}}function x(t,e,n){return function(){this.style.setProperty(t,e,n)}}function P(t,e,n){return function(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function O(t){return function(){delete this[t]}}function S(t,e){return function(){this[t]=e}}function j(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function D(t){return t.trim().split(/^|\s+/)}function k(t){return t.classList||new T(t)}function T(t){this._node=t,this._names=D(t.getAttribute("class")||"")}function M(t,e){for(var n=k(t),r=-1,o=e.length;++r<o;)n.add(e[r])}function C(t,e){for(var n=k(t),r=-1,o=e.length;++r<o;)n.remove(e[r])}function N(t){return function(){M(this,t)}}function L(t){return function(){C(this,t)}}function I(t,e){return function(){(e.apply(this,arguments)?M:C)(this,t)}}function V(){this.textContent=""}function R(t){return function(){this.textContent=t}}function q(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function z(){this.innerHTML=""}function B(t){return function(){this.innerHTML=t}}function U(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function H(){this.nextSibling&&this.parentNode.appendChild(this)}function F(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function G(){return null}function X(){var t=this.parentNode;t&&t.removeChild(this)}function Y(t,e,n){var r=Nt(t),o=r.CustomEvent;o?o=new o(e,n):(o=r.document.createEvent("Event"),n?(o.initEvent(e,n.bubbles,n.cancelable),o.detail=n.detail):o.initEvent(e,!1,!1)),t.dispatchEvent(o)}function $(t,e){return function(){return Y(this,t,e)}}function J(t,e){return function(){return Y(this,t,e.apply(this,arguments))}}function K(t,e){this._groups=t,this._parents=e}function Q(){return new K([[document.documentElement]],Yt)}var W="http://www.w3.org/1999/xhtml",Z={svg:"http://www.w3.org/2000/svg",xhtml:W,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},tt=function(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),Z.hasOwnProperty(e)?{space:Z[e],local:t}:t},et=function(t){var r=tt(t);return(r.local?n:e)(r)},nt=0;o.prototype=r.prototype={constructor:o,get:function(t){for(var e=this._;!(e in t);)if(!(t=t.parentNode))return;return t[e]},set:function(t,e){return t[this._]=e},remove:function(t){return this._ in t&&delete t[this._]},toString:function(){return this._}};var rt=function(t){return function(){return this.matches(t)}};if("undefined"!=typeof document){var ot=document.documentElement;if(!ot.matches){var it=ot.webkitMatchesSelector||ot.msMatchesSelector||ot.mozMatchesSelector||ot.oMatchesSelector;rt=function(t){return function(){return it.call(this,t)}}}}var ut=rt,at={};if(t.event=null,"undefined"!=typeof document){var ct=document.documentElement;"onmouseenter"in ct||(at={mouseenter:"mouseover",mouseleave:"mouseout"})}var st=function(t,e,n){var r,o,i=a(t+""),u=i.length;{if(!(arguments.length<2)){for(l=e?s:c,null==n&&(n=!1),r=0;r<u;++r)this.each(l(i[r],e,n));return this}var l=this.node().__on;if(l)for(var f,h=0,p=l.length;h<p;++h)for(r=0,f=l[h];r<u;++r)if((o=i[r]).type===f.type&&o.name===f.name)return f.value}},lt=function(){for(var e,n=t.event;e=n.sourceEvent;)n=e;return n},ft=function(t,e){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}var o=t.getBoundingClientRect();return[e.clientX-o.left-t.clientLeft,e.clientY-o.top-t.clientTop]},ht=function(t){var e=lt();return e.changedTouches&&(e=e.changedTouches[0]),ft(t,e)},pt=function(t){return null==t?f:function(){return this.querySelector(t)}},vt=function(t){"function"!=typeof t&&(t=pt(t));for(var e=this._groups,n=e.length,r=new Array(n),o=0;o<n;++o)for(var i,u,a=e[o],c=a.length,s=r[o]=new Array(c),l=0;l<c;++l)(i=a[l])&&(u=t.call(i,i.__data__,l,a))&&("__data__"in i&&(u.__data__=i.__data__),s[l]=u);return new K(r,this._parents)},gt=function(t){return null==t?h:function(){return this.querySelectorAll(t)}},dt=function(t){"function"!=typeof t&&(t=gt(t));for(var e=this._groups,n=e.length,r=[],o=[],i=0;i<n;++i)for(var u,a=e[i],c=a.length,s=0;s<c;++s)(u=a[s])&&(r.push(t.call(u,u.__data__,s,a)),o.push(u));return new K(r,o)},yt=function(t){"function"!=typeof t&&(t=ut(t));for(var e=this._groups,n=e.length,r=new Array(n),o=0;o<n;++o)for(var i,u=e[o],a=u.length,c=r[o]=[],s=0;s<a;++s)(i=u[s])&&t.call(i,i.__data__,s,u)&&c.push(i);return new K(r,this._parents)},mt=function(t){return new Array(t.length)},_t=function(){return new K(this._enter||this._groups.map(mt),this._parents)};p.prototype={constructor:p,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var wt=function(t){return function(){return t}},bt="$",Et=function(t,e){if(!t)return p=new Array(this.size()),s=-1,this.each(function(t){p[++s]=t}),p;var n=e?g:v,r=this._parents,o=this._groups;"function"!=typeof t&&(t=wt(t));for(var i=o.length,u=new Array(i),a=new Array(i),c=new Array(i),s=0;s<i;++s){var l=r[s],f=o[s],h=f.length,p=t.call(l,l&&l.__data__,s,r),d=p.length,y=a[s]=new Array(d),m=u[s]=new Array(d),_=c[s]=new Array(h);n(l,f,y,m,_,p,e);for(var w,b,E=0,A=0;E<d;++E)if(w=y[E]){for(E>=A&&(A=E+1);!(b=m[A])&&++A<d;);w._next=b||null}}return u=new K(u,r),u._enter=a,u._exit=c,u},At=function(){return new K(this._exit||this._groups.map(mt),this._parents)},xt=function(t){for(var e=this._groups,n=t._groups,r=e.length,o=n.length,i=Math.min(r,o),u=new Array(r),a=0;a<i;++a)for(var c,s=e[a],l=n[a],f=s.length,h=u[a]=new Array(f),p=0;p<f;++p)(c=s[p]||l[p])&&(h[p]=c);for(;a<r;++a)u[a]=e[a];return new K(u,this._parents)},Pt=function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r,o=t[e],i=o.length-1,u=o[i];--i>=0;)(r=o[i])&&(u&&u!==r.nextSibling&&u.parentNode.insertBefore(r,u),u=r);return this},Ot=function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=d);for(var n=this._groups,r=n.length,o=new Array(r),i=0;i<r;++i){for(var u,a=n[i],c=a.length,s=o[i]=new Array(c),l=0;l<c;++l)(u=a[l])&&(s[l]=u);s.sort(e)}return new K(o,this._parents).order()},St=function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},jt=function(){var t=new Array(this.size()),e=-1;return this.each(function(){t[++e]=this}),t},Dt=function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],o=0,i=r.length;o<i;++o){var u=r[o];if(u)return u}return null},kt=function(){var t=0;return this.each(function(){++t}),t},Tt=function(){return!this.node()},Mt=function(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var o,i=e[n],u=0,a=i.length;u<a;++u)(o=i[u])&&t.call(o,o.__data__,u,i);return this},Ct=function(t,e){var n=tt(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==e?n.local?m:y:"function"==typeof e?n.local?E:b:n.local?w:_)(n,e))},Nt=function(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView},Lt=function(t,e,n){var r;return arguments.length>1?this.each((null==e?A:"function"==typeof e?P:x)(t,e,null==n?"":n)):Nt(r=this.node()).getComputedStyle(r,null).getPropertyValue(t)},It=function(t,e){return arguments.length>1?this.each((null==e?O:"function"==typeof e?j:S)(t,e)):this.node()[t]};T.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var Vt=function(t,e){var n=D(t+"");if(arguments.length<2){for(var r=k(this.node()),o=-1,i=n.length;++o<i;)if(!r.contains(n[o]))return!1;return!0}return this.each(("function"==typeof e?I:e?N:L)(n,e))},Rt=function(t){return arguments.length?this.each(null==t?V:("function"==typeof t?q:R)(t)):this.node().textContent},qt=function(t){return arguments.length?this.each(null==t?z:("function"==typeof t?U:B)(t)):this.node().innerHTML},zt=function(){return this.each(H)},Bt=function(){return this.each(F)},Ut=function(t){var e="function"==typeof t?t:et(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})},Ht=function(t,e){var n="function"==typeof t?t:et(t),r=null==e?G:"function"==typeof e?e:pt(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})},Ft=function(){return this.each(X)},Gt=function(t){return arguments.length?this.property("__data__",t):this.node().__data__},Xt=function(t,e){return this.each(("function"==typeof e?J:$)(t,e))},Yt=[null];K.prototype=Q.prototype={constructor:K,select:vt,selectAll:dt,filter:yt,data:Et,enter:_t,exit:At,merge:xt,order:Pt,sort:Ot,call:St,nodes:jt,node:Dt,size:kt,empty:Tt,each:Mt,attr:Ct,style:Lt,property:It,classed:Vt,text:Rt,html:qt,raise:zt,lower:Bt,append:Ut,insert:Ht,remove:Ft,datum:Gt,on:st,dispatch:Xt};var $t=function(t){return"string"==typeof t?new K([[document.querySelector(t)]],[document.documentElement]):new K([[t]],Yt)},Jt=function(t){return"string"==typeof t?new K([document.querySelectorAll(t)],[document.documentElement]):new K([null==t?[]:t],Yt)},Kt=function(t,e,n){arguments.length<3&&(n=e,e=lt().changedTouches);for(var r,o=0,i=e?e.length:0;o<i;++o)if((r=e[o]).identifier===n)return ft(t,r);return null},Qt=function(t,e){null==e&&(e=lt().touches);for(var n=0,r=e?e.length:0,o=new Array(r);n<r;++n)o[n]=ft(t,e[n]);return o};t.creator=et,t.local=r,t.matcher=ut,t.mouse=ht,t.namespace=tt,t.namespaces=Z,t.select=$t,t.selectAll=Jt,t.selection=Q,t.selector=pt,t.selectorAll=gt,t.touch=Kt,t.touches=Qt,t.window=Nt,t.customEvent=l,Object.defineProperty(t,"__esModule",{value:!0})})},function(t,e,n){(function(t){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0}),e.DraggableAnnotationAccessor=void 0;var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(7),c=n(9);e.DraggableAnnotationAccessor=function(e){function n(){return r(this,n),o(this,(n.__proto__||Object.getPrototypeOf(n)).apply(this,arguments))}return i(n,e),u(n,null,[{key:"isSupported",value:function(){return!!t.Annotation}},{key:"getElements",value:function(t){return a.DraggableElementAccessor.getElements(t,Object.keys(t.annotation.elements).map(function(e){return t.annotation.elements[e]}),Object.keys(t.annotation.elements).map(function(e){return t.annotation.elements[e].options}),function(t){switch(t.type){case"line":return c.DraggableLineAnnotationElement}})}}]),n}(a.DraggableElementAccessor)}).call(e,n(1))},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0}),e.DraggableElementAccessor=void 0;var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),i=n(8);e.DraggableElementAccessor=function(){function t(){r(this,t)}return o(t,null,[{key:"isSupported",value:function(){return!0}},{key:"getElements",value:function(t,e,n,r){var o="function"==typeof r?r:function(){return r};return e.map(function(e,r){var u=o(n[r])||i.DraggableElement;return new u(t,e,n[r])}).filter(function(t,e){return!!n[e].draggable})}}]),t}()},function(t,e){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();e.DraggableElement=function(){function t(e,r,o){n(this,t),this.chart=e,this.element=r,this.config=o}return r(t,[{key:"_constrainValue",value:function(t,e){return"undefined"!=typeof t.min&&e<t.min?t.min:"undefined"!=typeof t.max&&e>t.max?t.max:e}},{key:"dispatch",value:function(t,e){"function"==typeof this[t]&&this[t](e),"function"==typeof this.config[t]&&this.config[t](e)}}]),t}()},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(e,"__esModule",{value:!0}),e.DraggableLineAnnotationElement=void 0;var u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=n(8);e.DraggableLineAnnotationElement=function(t){function e(t,n,i){r(this,e);var u=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,i));return u.scale=u.chart.scales[i.scaleID],u}return i(e,t),u(e,[{key:"_getPixel",value:function(t){return this.scale.isHorizontal()?t.x:t.y}},{key:"_getValue",value:function(t){var e=this.offset||0;return this.scale.getValueForPixel(this._getPixel(t)-e)}},{key:"onDragStart",value:function(t){this.offset=this._getPixel(t)-this.scale.getPixelForValue(this.config.value)}},{key:"onDrag",value:function(t){this.config.value=this._constrainValue(this.scale,this._getValue(t)),this.chart.update(0)}},{key:"onDragEnd",value:function(t){this.offset=void 0}}]),e}(a.DraggableElement)}]);
</script>
<script>
    var data = {
        "model": {
            "tenantId": "344465a6-cdc9-4a51-b001-2c46d63a358a",
            "id": "iris",
            "threshold": 0.0,
            "errorCost": 5.0,
            "abstainCost": 1.0,
            "correctCost": 0.0
        },
        "samples": 75,
        "outcomes": 3,
        "stats": [
            {
                "threshold": 0.0,
                "correct": 0.68,
                "error": 0.32,
                "abstain": 0.0
            },
            {
                "threshold": 0.01,
                "correct": 0.68,
                "error": 0.32,
                "abstain": 0.0
            },
            {
                "threshold": 0.02,
                "correct": 0.68,
                "error": 0.32,
                "abstain": 0.0
            },
            {
                "threshold": 0.03,
                "correct": 0.68,
                "error": 0.32,
                "abstain": 0.0
            },
            {
                "threshold": 0.04,
                "correct": 0.68,
                "error": 0.32,
                "abstain": 0.0
            },
            {
                "threshold": 0.05,
                "correct": 0.68,
                "error": 0.32,
                "abstain": 0.0
            },
            {
                "threshold": 0.06,
                "correct": 0.68,
                "error": 0.32,
                "abstain": 0.0
            },
            {
                "threshold": 0.07,
                "correct": 0.68,
                "error": 0.32,
                "abstain": 0.0
            },
            {
                "threshold": 0.08,
                "correct": 0.68,
                "error": 0.32,
                "abstain": 0.0
            },
            {
                "threshold": 0.09,
                "correct": 0.68,
                "error": 0.32,
                "abstain": 0.0
            },
            {
                "threshold": 0.1,
                "correct": 0.68,
                "error": 0.32,
                "abstain": 0.0
            },
            {
                "threshold": 0.11,
                "correct": 0.68,
                "error": 0.32,
                "abstain": 0.0
            },
            {
                "threshold": 0.12,
                "correct": 0.68,
                "error": 0.32,
                "abstain": 0.0
            },
            {
                "threshold": 0.13,
                "correct": 0.68,
                "error": 0.32,
                "abstain": 0.0
            },
            {
                "threshold": 0.14,
                "correct": 0.68,
                "error": 0.32,
                "abstain": 0.0
            },
            {
                "threshold": 0.15,
                "correct": 0.68,
                "error": 0.32,
                "abstain": 0.0
            },
            {
                "threshold": 0.16,
                "correct": 0.68,
                "error": 0.32,
                "abstain": 0.0
            },
            {
                "threshold": 0.17,
                "correct": 0.68,
                "error": 0.32,
                "abstain": 0.0
            },
            {
                "threshold": 0.18,
                "correct": 0.68,
                "error": 0.32,
                "abstain": 0.0
            },
            {
                "threshold": 0.19,
                "correct": 0.68,
                "error": 0.32,
                "abstain": 0.0
            },
            {
                "threshold": 0.2,
                "correct": 0.68,
                "error": 0.32,
                "abstain": 0.0
            },
            {
                "threshold": 0.21,
                "correct": 0.68,
                "error": 0.32,
                "abstain": 0.0
            },
            {
                "threshold": 0.22,
                "correct": 0.68,
                "error": 0.32,
                "abstain": 0.0
            },
            {
                "threshold": 0.23,
                "correct": 0.68,
                "error": 0.32,
                "abstain": 0.0
            },
            {
                "threshold": 0.24,
                "correct": 0.68,
                "error": 0.32,
                "abstain": 0.0
            },
            {
                "threshold": 0.25,
                "correct": 0.68,
                "error": 0.32,
                "abstain": 0.0
            },
            {
                "threshold": 0.26,
                "correct": 0.68,
                "error": 0.32,
                "abstain": 0.0
            },
            {
                "threshold": 0.27,
                "correct": 0.68,
                "error": 0.32,
                "abstain": 0.0
            },
            {
                "threshold": 0.28,
                "correct": 0.68,
                "error": 0.29333333333333333,
                "abstain": 0.02666666666666667
            },
            {
                "threshold": 0.29,
                "correct": 0.68,
                "error": 0.29333333333333333,
                "abstain": 0.02666666666666667
            },
            {
                "threshold": 0.3,
                "correct": 0.68,
                "error": 0.28,
                "abstain": 0.04
            },
            {
                "threshold": 0.31,
                "correct": 0.68,
                "error": 0.28,
                "abstain": 0.04
            },
            {
                "threshold": 0.32,
                "correct": 0.6666666666666666,
                "error": 0.22666666666666666,
                "abstain": 0.10666666666666667
            },
            {
                "threshold": 0.33,
                "correct": 0.6533333333333333,
                "error": 0.16,
                "abstain": 0.18666666666666668
            },
            {
                "threshold": 0.34,
                "correct": 0.64,
                "error": 0.14666666666666667,
                "abstain": 0.21333333333333335
            },
            {
                "threshold": 0.35,
                "correct": 0.64,
                "error": 0.13333333333333333,
                "abstain": 0.22666666666666666
            },
            {
                "threshold": 0.36,
                "correct": 0.6133333333333333,
                "error": 0.10666666666666667,
                "abstain": 0.28
            },
            {
                "threshold": 0.37,
                "correct": 0.5733333333333334,
                "error": 0.08,
                "abstain": 0.3466666666666667
            },
            {
                "threshold": 0.38,
                "correct": 0.5333333333333333,
                "error": 0.06666666666666667,
                "abstain": 0.4
            },
            {
                "threshold": 0.39,
                "correct": 0.5333333333333333,
                "error": 0.05333333333333334,
                "abstain": 0.41333333333333333
            },
            {
                "threshold": 0.4,
                "correct": 0.5066666666666667,
                "error": 0.05333333333333334,
                "abstain": 0.44
            },
            {
                "threshold": 0.41,
                "correct": 0.5066666666666667,
                "error": 0.04,
                "abstain": 0.4533333333333333
            },
            {
                "threshold": 0.42,
                "correct": 0.49333333333333335,
                "error": 0.02666666666666667,
                "abstain": 0.48
            },
            {
                "threshold": 0.43,
                "correct": 0.48,
                "error": 0.013333333333333334,
                "abstain": 0.5066666666666667
            },
            {
                "threshold": 0.44,
                "correct": 0.4666666666666667,
                "error": 0.0,
                "abstain": 0.5333333333333333
            },
            {
                "threshold": 0.45,
                "correct": 0.4533333333333333,
                "error": 0.0,
                "abstain": 0.5466666666666666
            },
            {
                "threshold": 0.46,
                "correct": 0.4266666666666667,
                "error": 0.0,
                "abstain": 0.5733333333333334
            },
            {
                "threshold": 0.47,
                "correct": 0.36,
                "error": 0.0,
                "abstain": 0.64
            },
            {
                "threshold": 0.48,
                "correct": 0.3333333333333333,
                "error": 0.0,
                "abstain": 0.6666666666666666
            },
            {
                "threshold": 0.49,
                "correct": 0.32,
                "error": 0.0,
                "abstain": 0.68
            },
            {
                "threshold": 0.5,
                "correct": 0.30666666666666664,
                "error": 0.0,
                "abstain": 0.6933333333333334
            },
            {
                "threshold": 0.51,
                "correct": 0.29333333333333333,
                "error": 0.0,
                "abstain": 0.7066666666666667
            },
            {
                "threshold": 0.52,
                "correct": 0.24,
                "error": 0.0,
                "abstain": 0.76
            },
            {
                "threshold": 0.53,
                "correct": 0.24,
                "error": 0.0,
                "abstain": 0.76
            },
            {
                "threshold": 0.54,
                "correct": 0.17333333333333334,
                "error": 0.0,
                "abstain": 0.8266666666666667
            },
            {
                "threshold": 0.55,
                "correct": 0.14666666666666667,
                "error": 0.0,
                "abstain": 0.8533333333333334
            },
            {
                "threshold": 0.56,
                "correct": 0.12,
                "error": 0.0,
                "abstain": 0.88
            },
            {
                "threshold": 0.57,
                "correct": 0.09333333333333334,
                "error": 0.0,
                "abstain": 0.9066666666666666
            },
            {
                "threshold": 0.58,
                "correct": 0.05333333333333334,
                "error": 0.0,
                "abstain": 0.9466666666666667
            },
            {
                "threshold": 0.59,
                "correct": 0.04,
                "error": 0.0,
                "abstain": 0.96
            },
            {
                "threshold": 0.6,
                "correct": 0.0,
                "error": 0.0,
                "abstain": 1.0
            },
            {
                "threshold": 0.61,
                "correct": 0.0,
                "error": 0.0,
                "abstain": 1.0
            },
            {
                "threshold": 0.62,
                "correct": 0.0,
                "error": 0.0,
                "abstain": 1.0
            },
            {
                "threshold": 0.63,
                "correct": 0.0,
                "error": 0.0,
                "abstain": 1.0
            },
            {
                "threshold": 0.64,
                "correct": 0.0,
                "error": 0.0,
                "abstain": 1.0
            },
            {
                "threshold": 0.65,
                "correct": 0.0,
                "error": 0.0,
                "abstain": 1.0
            },
            {
                "threshold": 0.66,
                "correct": 0.0,
                "error": 0.0,
                "abstain": 1.0
            },
            {
                "threshold": 0.67,
                "correct": 0.0,
                "error": 0.0,
                "abstain": 1.0
            },
            {
                "threshold": 0.68,
                "correct": 0.0,
                "error": 0.0,
                "abstain": 1.0
            },
            {
                "threshold": 0.69,
                "correct": 0.0,
                "error": 0.0,
                "abstain": 1.0
            },
            {
                "threshold": 0.7,
                "correct": 0.0,
                "error": 0.0,
                "abstain": 1.0
            },
            {
                "threshold": 0.71,
                "correct": 0.0,
                "error": 0.0,
                "abstain": 1.0
            },
            {
                "threshold": 0.72,
                "correct": 0.0,
                "error": 0.0,
                "abstain": 1.0
            },
            {
                "threshold": 0.73,
                "correct": 0.0,
                "error": 0.0,
                "abstain": 1.0
            },
            {
                "threshold": 0.74,
                "correct": 0.0,
                "error": 0.0,
                "abstain": 1.0
            },
            {
                "threshold": 0.75,
                "correct": 0.0,
                "error": 0.0,
                "abstain": 1.0
            },
            {
                "threshold": 0.76,
                "correct": 0.0,
                "error": 0.0,
                "abstain": 1.0
            },
            {
                "threshold": 0.77,
                "correct": 0.0,
                "error": 0.0,
                "abstain": 1.0
            },
            {
                "threshold": 0.78,
                "correct": 0.0,
                "error": 0.0,
                "abstain": 1.0
            },
            {
                "threshold": 0.79,
                "correct": 0.0,
                "error": 0.0,
                "abstain": 1.0
            },
            {
                "threshold": 0.8,
                "correct": 0.0,
                "error": 0.0,
                "abstain": 1.0
            },
            {
                "threshold": 0.81,
                "correct": 0.0,
                "error": 0.0,
                "abstain": 1.0
            },
            {
                "threshold": 0.82,
                "correct": 0.0,
                "error": 0.0,
                "abstain": 1.0
            },
            {
                "threshold": 0.83,
                "correct": 0.0,
                "error": 0.0,
                "abstain": 1.0
            },
            {
                "threshold": 0.84,
                "correct": 0.0,
                "error": 0.0,
                "abstain": 1.0
            },
            {
                "threshold": 0.85,
                "correct": 0.0,
                "error": 0.0,
                "abstain": 1.0
            },
            {
                "threshold": 0.86,
                "correct": 0.0,
                "error": 0.0,
                "abstain": 1.0
            },
            {
                "threshold": 0.87,
                "correct": 0.0,
                "error": 0.0,
                "abstain": 1.0
            },
            {
                "threshold": 0.88,
                "correct": 0.0,
                "error": 0.0,
                "abstain": 1.0
            },
            {
                "threshold": 0.89,
                "correct": 0.0,
                "error": 0.0,
                "abstain": 1.0
            },
            {
                "threshold": 0.9,
                "correct": 0.0,
                "error": 0.0,
                "abstain": 1.0
            },
            {
                "threshold": 0.91,
                "correct": 0.0,
                "error": 0.0,
                "abstain": 1.0
            },
            {
                "threshold": 0.92,
                "correct": 0.0,
                "error": 0.0,
                "abstain": 1.0
            },
            {
                "threshold": 0.93,
                "correct": 0.0,
                "error": 0.0,
                "abstain": 1.0
            },
            {
                "threshold": 0.94,
                "correct": 0.0,
                "error": 0.0,
                "abstain": 1.0
            },
            {
                "threshold": 0.95,
                "correct": 0.0,
                "error": 0.0,
                "abstain": 1.0
            },
            {
                "threshold": 0.96,
                "correct": 0.0,
                "error": 0.0,
                "abstain": 1.0
            },
            {
                "threshold": 0.97,
                "correct": 0.0,
                "error": 0.0,
                "abstain": 1.0
            },
            {
                "threshold": 0.98,
                "correct": 0.0,
                "error": 0.0,
                "abstain": 1.0
            },
            {
                "threshold": 0.99,
                "correct": 0.0,
                "error": 0.0,
                "abstain": 1.0
            },
            {
                "threshold": 1.0,
                "correct": 0.0,
                "error": 0.0,
                "abstain": 1.0
            }
        ]
    };
    var errors = data.stats.map(function (p) {
        return {"x": p.threshold, "y": Math.round(p.error * 100)}
    });
    var abstains = data.stats.map(function (p) {
        return {"x": p.threshold, "y":Math.round(p.abstain * 100)}
    });
    var corrects = data.stats.map(function (p) {
        return {"x": p.threshold, "y":Math.round(p.correct * 100)}
    });

    $("#model-id").text(data.model.id);
    $("#n-samples").text(data.samples);
    $("#n-classes").text(data.outcomes);
    $("#correct").text(corrects[0].y);
    $("#abstain").text(abstains[0].y);
    $("#errors").text(errors[0].y);

    $("#error-cost").val(data.model.errorCost);
    $("#abstain-cost").val(data.model.abstainCost);
    $("#correct-cost").val(data.model.correctCost);

    var red = "rgb(255, 99, 132)";
    var green = "rgb(75, 192, 192)";
    var blue = "rgb(54, 162, 235)";

    var config = {
        type: 'line',
        data: {
            datasets: [{
                pointRadius: 0,
                label: 'Error',
                backgroundColor: red,
                borderColor: red,
                data: errors,
                fill: false
            }, {
                pointRadius: 0,
                label: 'Abstain',
                fill: false,
                backgroundColor: blue,
                borderColor: blue,
                data: abstains
            }, {
                pointRadius: 0,
                label: 'Correct',
                fill: false,
                backgroundColor: green,
                borderColor: green,
                data: corrects
            }]
        },
        options: {
            responsive: false,
            title: {
                display: false
            },
            tooltips: {
                mode: 'index',
                intersect: false
            },
            hover: {
                mode: 'nearest',
                intersect: true
            },
            scales: {
                xAxes: [{
                    display: true,
                    scaleLabel: {
                        display: true,
                        labelString: 'Threshold'
                    }
                }],
                yAxes: [{
                    display: true,
                    scaleLabel: {
                        display: true,
                        labelString: 'Percent'
                    }
                }]
            }
        }
    };

    function updateStats(threshold, costPoints){
        console.log(threshold)
    }

    function drawCostGraph() {
        var ctx = document.getElementById('cost-graph').getContext('2d');

        var errorCost = parseFloat($("#error-cost").val());
        var abstainCost = parseFloat($("#abstain-cost").val());
        var correctCost = parseFloat($("#correct-cost").val());
        var costPoints = data.stats.map(function(p){
            return {"x": p.threshold, "y": errorCost * p.error + abstainCost * p.abstain + correctCost * p.correct}
        });
        console.log(costPoints);

        var config = {
            type: 'line',
            data: {
                datasets: [{
                    pointRadius: 0.0,
                    label: 'Cost',
                    backgroundColor: blue,
                    borderColor: blue,
                    data: costPoints,
                    fill: false
                }]
            },
            options: {
                annotation: {
                    drawTime: "afterDraw",
                    events: ['click'],
                    annotations: [{
                        type: 'line',
                        mode: 'vertical',
                        scaleID: 'x-axis-1',
                        value: 0.5,
                        borderColor: blue,
                        borderWidth: 5,
                        label: {
                            enabled: true,
                            content: "Threshold"
                        },
                        draggable: true,
                        onClick: function (e) {
                            console.log(e.type, this);
                        },
                        onDrag: function(e){
                            updateStats(e.subject.config.value, costPoints);
                        }
                    }]
                },
                responsive: false,
                title: {
                    display: false
                },
                tooltips: {
                    mode: 'index',
                    intersect: false
                },
                hover: {
                    mode: 'nearest',
                    intersect: true
                },
                scales: {
                    xAxes: [{
                        display: true,
                        scaleLabel: {
                            display: true,
                            labelString: 'Threshold'
                        }
                    }],
                    yAxes: [{
                        display: true,
                        scaleLabel: {
                            display: true,
                            labelString: 'Cost'
                        }
                    }]
                }
            }
        };
        window.costChart = new Chart.Scatter(ctx, config);
    }

    window.onload = function () {
        var ctx = document.getElementById('errors-correct-abstain-graph').getContext('2d');
        window.errorsCorrectAbstainChart = new Chart.Scatter(ctx, config);
        drawCostGraph();
    };




</script>
</body>
</html>